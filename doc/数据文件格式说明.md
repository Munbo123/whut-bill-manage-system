# 数据文件格式说明

本系统使用文本文件存储数据，包括卡信息、计费记录以及充值/退费记录。以下是各数据文件的格式说明。

## cards.dat - 卡信息数据文件

**文件格式**：
```
记录总数
卡号,密码,状态,开卡时间,截止时间,累计消费,上次使用时间,使用次数,余额,删除标志
```

**字段详解**：

| 序号 | 字段名 | 数据类型 | 说明 |
|------|--------|----------|------|
| 1 | 卡号 | 字符串 | 唯一标识符，最多18位 |
| 2 | 密码 | 字符串 | 卡密码，最多8位 |
| 3 | 状态 | 整数 | 0=未上机，1=正在上机，2=注销，3=失效 |
| 4 | 开卡时间 | 时间戳 | Unix时间戳，表示开卡时间 |
| 5 | 截止时间 | 时间戳 | Unix时间戳，表示卡的有效期 |
| 6 | 累计消费 | 浮点数 | 累计消费金额，单位：元 |
| 7 | 上次使用时间 | 时间戳 | Unix时间戳，表示上次上机时间 |
| 8 | 使用次数 | 整数 | 上机次数统计 |
| 9 | 余额 | 浮点数 | 卡内余额，单位：元 |
| 10 | 删除标志 | 整数 | 0=未创建，1=已创建，2=已注销，3=已失效 |

**示例**：
```
2
10001,123456,0,1746773000,0,0.00,0,0,100.00,0
10002,654321,1,1746773100,0,25.50,1746773200,2,74.50,0
```

## charges.dat - 计费记录数据文件

**文件格式**：
```
记录总数
卡号,上机时间,下机时间,计费金额,状态,删除标志
```

**字段详解**：

| 序号 | 字段名 | 数据类型 | 说明 |
|------|--------|----------|------|
| 1 | 卡号 | 字符串 | 关联的卡号 |
| 2 | 上机时间 | 时间戳 | Unix时间戳，表示开始上机时间 |
| 3 | 下机时间 | 时间戳 | Unix时间戳，表示结束上机时间 |
| 4 | 计费金额 | 浮点数 | 本次消费金额，单位：元 |
| 5 | 状态 | 整数 | 0=未结算，1=已结算 |
| 6 | 删除标志 | 整数 | 0=未删除，1=已删除 |

**示例**：
```
2
10001,1746773200,1746776800,15.00,1,0
10002,1746777000,1746784200,25.50,1,0
```

## recharges.dat - 充值/退费记录数据文件

**文件格式**：
```
记录总数
卡号,操作时间,操作类型,金额,删除标志
```

**字段详解**：

| 序号 | 字段名 | 数据类型 | 说明 |
|------|--------|----------|------|
| 1 | 卡号 | 字符串 | 关联的卡号 |
| 2 | 操作时间 | 时间戳 | Unix时间戳，表示操作发生的时间 |
| 3 | 操作类型 | 整数 | 0=充值，1=退费 |
| 4 | 金额 | 浮点数 | 充值/退费金额，单位：元 |
| 5 | 删除标志 | 整数 | 0=未删除，1=已删除 |

**示例**：
```
2
12345,1746773261,0,114514.00,0
12345,1746773279,1,126853.00,0
```

## 时间戳转换说明

所有时间戳字段都是使用Unix时间戳（从1970年1月1日00:00:00 UTC开始的秒数）。
可以使用以下方法查看具体时间：

1. 在程序中：使用C语言的`ctime()`函数将时间戳转换为可读时间。
2. 在线工具：使用时间戳转换网站（如timestamp.cn）输入时间戳查看具体日期时间。

## 文件维护注意事项

1. 不要手动删除数据文件中的行，这可能导致记录总数与实际条目不一致。
2. 修改数据时请保持格式一致，尤其是逗号分隔符。
3. 修改时间戳时请确保输入的是有效的Unix时间戳。
4. 建议修改前备份数据文件。